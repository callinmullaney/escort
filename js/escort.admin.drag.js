!function(e,t,r){"use strict";r.behaviors.escortAdminDrag={attach:function(s,n){function o(t,r){t.find("tr.region-message").each(function(){var t=e(this);t.prev("tr").get(0)===r.element&&("keyboard"===r.method&&"down"!==r.direction||r.swap("after",this)),t.next("tr").is(":not(.draggable)")||0===t.next("tr").length?t.removeClass("region-populated").addClass("region-empty"):t.is(".region-empty")&&t.removeClass("region-empty").addClass("region-populated")})}function a(t,r){t.find(".color-success").removeClass("color-success");var s=e(r);s.is(".drag-previous")||(t.find(".drag-previous").removeClass("drag-previous"),s.addClass("drag-previous"))}function i(e,t){var r=-Math.round(e.find(".draggable").length/2);e.find(".region-"+t+"-message").nextUntil(".region-title").find("select.escort-weight").val(function(){return++r})}if("undefined"!=typeof r.tableDrag&&"undefined"!=typeof r.tableDrag.escorts){var g=e("#escorts"),c=r.tableDrag.escorts;c.row.prototype.onSwap=function(e){o(g,this),a(g,this)},c.onDrop=function(){var s=this,n=e(s.rowObject.element),o=n.prevAll("tr.region-message").get(0),a=o.className.replace(/([^ ]+[ ]+)*region-([^ ]+)-message([ ]+[^ ]+)*/,"$2"),c=n.find("select.escort-region-select");if(0===c.find("option[value="+a+"]").length&&(t.alert(r.t("The escort cannot be placed in this region.")),c.trigger("change")),!c.is(".escort-region-"+a)){var l=n.find("select.escort-weight"),d=l[0].className.replace(/([^ ]+[ ]+)*escort-weight-([^ ]+)([ ]+[^ ]+)*/,"$2");c.removeClass("escort-region-"+d).addClass("escort-region-"+a),l.removeClass("escort-weight-"+d).addClass("escort-weight-"+a),c.val(a)}i(g,a)},e(s).find("select.escort-region-select").once("escort-region-select").on("change",function(t){var s=e(this).closest("tr"),n=e(this);c.rowObject=new c.row(s[0]);var l=g.find(".region-"+n[0].value+"-message"),d=l.nextUntil(".region-message, .region-title");d.length?d.last().after(s):l.after(s),i(g,n[0].value),o(g,c.rowObject),a(g,s),c.changed||(e(r.theme("tableDragChangedWarning")).insertBefore(c.table).hide().fadeIn("slow"),c.changed=!0),n.trigger("blur")})}}}}(jQuery,window,Drupal);